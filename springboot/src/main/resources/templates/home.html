<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>WE READ UP - 홈페이지</title>
    <link rel="icon" href="/img/read-up-logo.png" type="text/png">
    <link rel="stylesheet" href="/css/fragments/header.css">
    <link rel="stylesheet" href="/css/fragments/footer.css">
    <link rel="stylesheet" href="/css/fragments/nav.css">
    <link rel="stylesheet" href="/css/fragments/chat.css">
    <link rel="stylesheet" href="/css/home.css">
</head>
<body th:attr="data-msg=${msg}">
<!-- 독서 성향 테스트 시작 팝업 -->
<div id="popup-container">
    <div class="popup-box">
        <button id="popup-close-btn">&times;</button>
        <h2>📚 당신의 독서 성향은?</h2>
        <p class="popup-intro-text">※ 당신의 독서 취향에 따른 성향 유형을 분석해 드릴게요!</p>
        <p class="popup-description">당신에게 꼭 맞는 책을 추천해드릴게요!</p>
        <button id="popup-start-btn">설문 시작하기</button>
        <button id="popup-hide-btn">24시간 동안 보지 않기</button>
    </div>
</div>

<!-- 독서 성향 테스트 질문 컨테이너 -->
<div id="questions-container">
    <div class="popup-box">
        <button id="ques-close-btn">&times;</button>
        <h2>어떤 쪽을 더 선호하시나요?</h2>

        <!-- 진행 상태 표시 -->
        <div class="progress-container">
            <div class="progress-bar">
                <div class="progress-fill"></div>
            </div>
            <div class="progress-text"></div>
        </div>

        <div class="question-wrapper">
            <!-- 질문 1: 현실/상상 (S/I) -->
            <div class="question-container active" id="q1">
                <p class="question-text" data-question="1">
                    실제 이야기를 바탕으로 한 논픽션이 끌리시나요?<br>아니면 상상력이 돋보이는 픽션이 끌리시나요?
                    <button class="nav-btn next-btn">&gt;</button>
                </p>
                <div class="ques-body">
                    <div class="choice-container">
                        <div class="scale-container" data-left-code="S" data-right-code="I">
                            <div class="scale-option" data-score="1">현실 중심 책에<br>가장 끌림</div>
                            <div class="scale-option" data-score="2">현실 중심 책에<br>약간 끌림</div>
                            <div class="scale-option" data-score="3">상상 중심 책에<br>약간 끌림</div>
                            <div class="scale-option" data-score="4">상상 중심 책에<br>가장 끌림</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 질문 2: 감성/정보 (F/D) -->
            <div class="question-container" id="q2">
                <p class="question-text" data-question="2">
                    <button class="nav-btn prev-btn">&lt;</button>
                    감성과 분위기가 중요하신가요?<br>아니면 정보와 전문성이 중요하신가요?
                    <button class="nav-btn next-btn">&gt;</button>
                </p>
                <div class="ques-body">
                    <div class="choice-container">
                        <div class="scale-container" data-left-code="F" data-right-code="D">
                            <div class="scale-option" data-score="1">감성 중심 책에<br>가장 끌림</div>
                            <div class="scale-option" data-score="2">감성 중심 책에<br>약간 끌림</div>
                            <div class="scale-option" data-score="3">정보 중심 책에<br>약간 끌림</div>
                            <div class="scale-option" data-score="4">정보 중심 책에<br>가장 끌림</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 질문 3: 이야기/메시지 (N/M) -->
            <div class="question-container" id="q3">
                <p class="question-text" data-question="3">
                    <button class="nav-btn prev-btn">&lt;</button>
                    이야기의 전개와 인물에 집중하시나요?<br>아니면 작품의 주제와 메시지에 집중하시나요?
                    <button class="nav-btn next-btn">&gt;</button>
                </p>
                <div class="ques-body">
                    <div class="choice-container">
                        <div class="scale-container" data-left-code="N" data-right-code="M">
                            <div class="scale-option" data-score="1">이야기 중심 책에<br>가장 끌림</div>
                            <div class="scale-option" data-score="2">이야기 중심 책에<br>약간 끌림</div>
                            <div class="scale-option" data-score="3">메시지 중심 책에<br>약간 끌림</div>
                            <div class="scale-option" data-score="4">메시지 중심 책에<br>가장 끌림</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 질문 4: 목표/자유 (Q/A) -->
            <div class="question-container" id="q4">
                <p class="question-text" data-question="4">
                    <button class="nav-btn prev-btn">&lt;</button>
                    목적을 가지고 책을 선택하시나요?<br>아니면 흥미가 가는 대로 선택하시나요?
                </p>
                <div class="ques-body">
                    <div class="choice-container">
                        <div class="scale-container" data-left-code="Q" data-right-code="A">
                            <div class="scale-option" data-score="1">목적 중심 책에<br>가장 끌림</div>
                            <div class="scale-option" data-score="2">목적 중심 책에<br>약간 끌림</div>
                            <div class="scale-option" data-score="3">자유 중심 책에<br>약간 끌림</div>
                            <div class="scale-option" data-score="4">자유 중심 책에<br>가장 끌림</div>
                        </div>
                    </div>
                </div>
                <button id="submit-btn">제출</button>
            </div>
        </div>
    </div>
</div>

<!-- 독서 성향 테스트 결과 팝업 -->
<div id="result-container">
    <div class="popup-box">

        <div id="type-info-btn">모든 유형 살펴보기</div>
        <button id="result-close-btn">&times;</button>

        <div id="type-info-box">
            <div class="type-grid" id="types-container"></div>
        </div>

        <h2>📚 당신의 독서 성향은...</h2>

        <div class="result-content">
            <div class="result-type">
                <h3 id="result-type-name"></h3>
                <p id="result-type-description"></p>
            </div>

            <!-- 도서 추천 버튼 -->
            <div class="recommend-btn-wrapper">
                <button id="recommend-btn">추천하는 책 알아보기</button>
            </div>
        </div>
    </div>
</div>

<!-- 추천 도서 리스트 -->
<div id="book-recommendation-modal">
    <div class="modal-content-wrapper">
        <button id="modal-close-btn">&times;</button>
        <h3>당신을 위한 맞춤 도서 추천</h3>
        <div class="recommendation-list">
            <div class="recommendation-slider">
                <div class="recommendation-card-grid"></div>
            </div>
        </div>
    </div>
</div>

<!-- 상단 배너 -->
<div id="mbti-banner">
    <span>📘 나만의 독서 성향 찾기! 지금 바로 <strong>테스트 참여</strong></span>
</div>

<div th:replace="~{fragments/header :: header}"></div>
<section class="new-books">
    <div id="h-slider-1" class="h-slider">
        <div class="h-slide-container">
            <div class="h-slider-body">
            </div>
            <div id="slide-control">
                <button type="button" class="slide-control-button" id="pause-button">❚❚</button>
                <button type="button" class="slide-control-button" id="play-button" style="display:none">▶</button>
                <div id="slider-bottom-text">
                    <a href="#" id="h-slide-prev">❮</a>
                    <span id="h-slide-number"></span>
                    <a href="#" id="h-slide-next">❯</a>
                </div>
            </div>
        </div>
    </div>
</section>
<section class="book-ranking">
    <div class="ranking-header">
        <div>
            <span class="ranking-title">주간 랭킹</span>
            <span class="ranking-subtitle">최근 1주일 동안 집계</span>
        </div>
    </div>
    <div class="product-grid">
        <div class="ranking_books" th:each="book : ${rankedBooks}" >
            <a th:href="@{'/book/bookDetail?bookId='+${book.bookAndCategory.bookId}}">
                <img th:src="${book.bookAndCategory.image}" th:alt="${book.bookAndCategory.name}">
            </a>
            <div id="book-text">
                <p class="ranking-book-category" th:text="${book.bookAndCategory.categoryMediumName} + '/' + ${book.bookAndCategory.categorySmallName}">카테고리</p>
                <a id="ranking-book-name" th:href="@{'/book/bookDetail?bookId='+${book.bookAndCategory.bookId}}">
                    <p class="ranking-book-name" th:text="${book.bookAndCategory.name}">도서명</p>
                </a>
                <p class="ranking-book-writers" id="ranking-book-writers">
                    <th:block th:each="writer, iterStat : ${book.writers}">
                        <span th:text="${writer}">저자명</span>
                        <span th:if="!${iterStat.last}">,</span>
                    </th:block>
                </p>
            </div>
        </div>
    </div>
</section>
<div th:replace="~{fragments/chat :: chatbot}"></div>
<div th:replace="~{fragments/footer :: footer}"></div>
<script th:inline="javascript">
    // 로그인 여부
    const loggedInUserId = [[${session.userId}]];
</script>
<!-- Lucide 아이콘 라이브러리 -->
<script src="https://unpkg.com/lucide@latest/dist/umd/lucide.min.js"></script>
<!-- Axios HTTP 클라이언트 라이브러리 -->
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script src="/js/home.js"></script>
<script src="/js/home-slider.js"></script>
<script src="/js/display-msg.js"></script>
</body>
</html>